const translations = {
    'ko': {
        'logo': 'Health Assistant',
        'nav-services': '서비스',
        'nav-process': '프로세스',
        'nav-testimonials': '후기',
        'nav-contact': '문의',
        'hero-title': '외국인을 위한 건강검진, <br>더 이상 복잡하지 않아요.',
        'hero-subtitle': 'Health Assistant가 예약부터 통역, 서류까지 모든 과정을 도와드립니다.',
        'hero-cta': '상담 신청하기',
        'services-title': '주요 서비스',
        'service-1-title': '병원 예약',
        'service-1-desc': '원하는 날짜와 시간에 맞춰 건강검진을 예약해드립니다.',
        'service-2-title': '통역 지원',
        'service-2-desc': '의료진과의 원활한 소통을 위해 전문 통역을 지원합니다.',
        'service-3-title': '서류 안내',
        'service-3-desc': '건강검진에 필요한 모든 서류를 안내하고 준비를 돕습니다.',
        'process-title': '진행 과정',
        'process-1-title': '상담 및 예약',
        'process-1-desc': '온라인으로 상담을 신청하고 원하는 병원과 시간을 선택합니다.',
        'process-2-title': '검진 진행',
        'process-2-desc': '예약된 날짜에 병원을 방문하여 어시스턴트와 함께 검진을 받습니다.',
        'process-3-title': '결과 확인',
        'process-3-desc': '검진 결과를 통역과 함께 상세히 안내받고, 관련 서류를 수령합니다.',
        'testimonials-title': '사용자 후기',
        'testimonial-1-text': '"정말 최고의 서비스였습니다. 예약부터 통역까지 완벽하게 도와주셔서 정말 편안하게 건강검진을 마칠 수 있었습니다."',
        'testimonial-2-text': '"한국 병원 방문이 처음이라 막막했는데, Health Assistant 덕분에 모든 것이 순조로웠습니다. 강력히 추천합니다!"',
        'contact-title': '문의하기',
        'contact-subtitle': '궁금한 점이 있다면 언제든지 문의해주세요.',
        'contact-email': '이메일 주소를 입력하세요',
        'contact-message': '문의 내용을 입력하세요',
        'contact-submit': '전송',
        'footer-copy': '© 2024 Health Assistant. All rights reserved.',
        'chat-title': '건강검진 FAQ 봇',
        'chat-welcome': '안녕하세요! 무엇을 도와드릴까요?'
    },
    'en': {
        'logo': 'Health Assistant',
        'nav-services': 'Services',
        'nav-process': 'Process',
        'nav-testimonials': 'Testimonials',
        'nav-contact': 'Contact',
        'hero-title': 'Health Checkups for Foreigners, <br>No Longer Complicated.',
        'hero-subtitle': 'Health Assistant helps you with everything from booking to interpretation and documentation.',
        'hero-cta': 'Apply for Consultation',
        'services-title': 'Key Services',
        'service-1-title': 'Hospital Booking',
        'service-1-desc': 'We book your health checkup according to your preferred date and time.',
        'service-2-title': 'Interpretation Support',
        'service-2-desc': 'We provide professional interpretation for smooth communication with medical staff.',
        'service-3-title': 'Document Guidance',
        'service-3-desc': 'We guide you through all necessary documents for the health checkup.',
        'process-title': 'Process',
        'process-1-title': 'Consultation & Booking',
        'process-1-desc': 'Apply for a consultation online and select your preferred hospital and time.',
        'process-2-title': 'Checkup Progress',
        'process-2-desc': 'Visit the hospital on the scheduled date and undergo the checkup with an assistant.',
        'process-3-title': 'Result Confirmation',
        'process-3-desc': 'Receive detailed guidance on checkup results with interpretation and collect related documents.',
        'testimonials-title': 'User Testimonials',
        'testimonial-1-text': '"It was truly the best service. They helped me perfectly from booking to interpretation, so I could finish my health checkup very comfortably."',
        'testimonial-2-text': '"I was lost since it was my first time visiting a Korean hospital, but thanks to Health Assistant, everything went smoothly. Highly recommended!"',
        'contact-title': 'Contact Us',
        'contact-subtitle': 'If you have any questions, feel free to contact us anytime.',
        'contact-email': 'Enter your email address',
        'contact-message': 'Enter your inquiry',
        'contact-submit': 'Send',
        'footer-copy': '© 2024 Health Assistant. All rights reserved.',
        'chat-title': 'Health FAQ Bot',
        'chat-welcome': 'Hello! How can I help you today?'
    },
    'zh': {
        'logo': 'Health Assistant',
        'nav-services': '服务',
        'nav-process': '流程',
        'nav-testimonials': '评价',
        'nav-contact': '联系我们',
        'hero-title': '面向外国人的体检，<br>不再复杂。',
        'hero-subtitle': 'Health Assistant 为您提供从预约到翻译、文件的全方位帮助。',
        'hero-cta': '申请咨询',
        'services-title': '主要服务',
        'service-1-title': '医院预约',
        'service-1-desc': '根据您希望的日期和时间为您预约体检。',
        'service-2-title': '翻译支持',
        'service-2-desc': '为了与医护人员顺畅沟通，提供专业翻译支持。',
        'service-3-title': '文件指南',
        'service-3-desc': '指导体检所需的所有文件并协助准备。',
        'process-title': '进行流程',
        'process-1-title': '咨询与预约',
        'process-1-desc': '在线申请咨询，选择心仪的医院和时间。',
        'process-2-title': '进行体检',
        'process-2-desc': '在预约日期前往医院，与助手一起进行体检。',
        'process-3-title': '确认结果',
        'process-3-desc': '在翻译的陪同下详细了解体检结果，并领取相关文件。',
        'testimonials-title': '用户评价',
        'testimonial-1-text': '"真的是最好的服务。从预约到翻译都提供了完美的帮助，让我非常轻松地完成了体检。"',
        'testimonial-2-text': '"因为是第一次去韩国医院，本来很茫然，多亏了 Health Assistant，一切都很顺畅。强烈推荐！"',
        'contact-title': '联系我们',
        'contact-subtitle': '如有任何疑问，请随时联系我们。',
        'contact-email': '请输入您的邮箱地址',
        'contact-message': '请输入咨询内容',
        'contact-submit': '发送',
        'footer-copy': '© 2024 Health Assistant. All rights reserved.',
        'chat-title': '健康体检 FAQ 机器人',
        'chat-welcome': '您好！有什么我可以帮您的吗？'
    }
};

const faqData = {
    'ko': [
        { q: '예약은 어떻게 하나요?', a: '상단 메뉴의 "상담 신청하기" 버튼을 누르거나 문의 폼을 작성해 주세요. 담당자가 연락드립니다.' },
        { q: '통역 비용은 얼마인가요?', a: '통역 비용은 검진 항목과 시간에 따라 다릅니다. 상담 시 상세히 안내해 드립니다.' },
        { q: '검진 당일 준비물은?', a: '여권 또는 외국인 등록증을 반드시 지참하셔야 합니다. 상세 서류는 예약 시 안내해 드립니다.' }
    ],
    'en': [
        { q: 'How do I make a booking?', a: 'Please click the "Apply for Consultation" button or fill out the contact form. Our staff will contact you soon.' },
        { q: 'How much is the interpretation fee?', a: 'The fee varies depending on the checkup items and time. We will provide details during the consultation.' },
        { q: 'What should I bring on the day?', a: 'You must bring your passport or Alien Registration Card (ARC). Other documents will be informed upon booking.' }
    ],
    'zh': [
        { q: '如何进行预约？', a: '请点击上方菜单中的“申请咨询”按钮或填写咨询表单。负责人会尽快与您联系。' },
        { q: '翻译费用是多少？', a: '翻译费用根据体检项目和时间而有所不同。咨询时会为您详细说明。' },
        { q: '体检当天需要准备什么？', a: '请务必携带护照或外国人登录证。详细材料将在预约时另行通知。' }
    ]
};

let currentLanguage = 'ko';

function changeLanguage(lang) {
    currentLanguage = lang;
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[lang][key]) {
            el.innerHTML = translations[lang][key];
        }
    });

    document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
        const key = el.getAttribute('data-i18n-placeholder');
        if (translations[lang][key]) {
            el.placeholder = translations[lang][key];
        }
    });

    // Update active button style
    document.querySelectorAll('.lang-switcher button, .chat-lang-selector button').forEach(btn => {
        btn.classList.remove('active');
        if (btn.getAttribute('onclick').includes(`'${lang}'`)) {
            btn.classList.add('active');
        }
    });

    // Save language preference
    localStorage.setItem('preferredLanguage', lang);

    // Refresh Chatbot FAQ
    renderFAQ();
}

function renderFAQ() {
    const faqOptions = document.getElementById('faq-options');
    faqOptions.innerHTML = '';
    
    faqData[currentLanguage].forEach(item => {
        const button = document.createElement('button');
        button.className = 'faq-button';
        button.textContent = item.q;
        button.onclick = () => handleFAQClick(item.q, item.a);
        faqOptions.appendChild(button);
    });
}

function handleFAQClick(question, answer) {
    const chatMessages = document.getElementById('chat-messages');
    
    // User message
    const userDiv = document.createElement('div');
    userDiv.className = 'message user-message';
    userDiv.textContent = question;
    chatMessages.appendChild(userDiv);
    
    // Bot message (slight delay)
    setTimeout(() => {
        const botDiv = document.createElement('div');
        botDiv.className = 'message bot-message';
        botDiv.textContent = answer;
        chatMessages.appendChild(botDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }, 300);
}

document.addEventListener('DOMContentLoaded', () => {
    // Smooth scrolling
    document.querySelectorAll('header a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            document.querySelector(this.getAttribute('href')).scrollIntoView({
                behavior: 'smooth'
            });
        });
    });

    // Chatbot toggle
    const chatToggle = document.getElementById('chat-toggle');
    const chatWindow = document.getElementById('chat-window');
    const chatClose = document.getElementById('chat-close');

    chatToggle.onclick = () => {
        chatWindow.classList.toggle('hidden');
    };

    chatClose.onclick = () => {
        chatWindow.classList.add('hidden');
    };

    // Load preferred language
    const preferredLanguage = localStorage.getItem('preferredLanguage') || 'ko';
    changeLanguage(preferredLanguage);
});
